# SNES LoROM Linker Configuration
# For use with ca65/ld65
#
# LoROM Memory Map:
#   Banks $00-$7D: ROM at $8000-$FFFF (32KB per bank)
#   Banks $00-$3F: RAM at $0000-$1FFF (8KB mirrored)
#   Banks $7E-$7F: Work RAM (128KB)
#
# This configuration supports ROMs up to 32KB (single bank).
# For larger ROMs, use lorom-multibank.cfg.

MEMORY {
    # Zero Page ($00-$FF) - Direct Page addressing
    ZP:      start = $00,    size = $100,   type = rw;

    # Low RAM ($0100-$1FFF) - Stack and general RAM
    # Stack typically at $01FF growing down
    LORAM:   start = $0100,  size = $1F00,  type = rw;

    # ROM Bank 0 ($8000-$FFAF) - Code and data
    # Leaves room for header and vectors at end
    ROM:     start = $8000,  size = $7FB0,  type = ro, file = %O, fill = yes;

    # SNES Internal Header ($FFB0-$FFDF)
    # Contains game title, ROM info, checksums
    HEADER:  start = $FFB0,  size = $30,    type = ro, file = %O, fill = yes;

    # Interrupt Vectors ($FFE0-$FFFF)
    # Native and emulation mode vectors
    VECTORS: start = $FFE0,  size = $20,    type = ro, file = %O, fill = yes;
}

SEGMENTS {
    # Zero page variables (fast access via Direct Page)
    ZEROPAGE: load = ZP,      type = zp;

    # BSS (uninitialized data in RAM)
    BSS:      load = LORAM,   type = bss;

    # Startup code (first in ROM, aligned for clarity)
    STARTUP:  load = ROM,     type = ro,  align = $100;

    # Main code segment
    CODE:     load = ROM,     type = ro;

    # Read-only data (lookup tables, strings, etc.)
    RODATA:   load = ROM,     type = ro;

    # Initialized data (copied to RAM at startup if needed)
    DATA:     load = ROM,     type = ro;

    # SNES ROM header (filled by crt0.s)
    HEADER:   load = HEADER,  type = ro;

    # Interrupt vectors (filled by crt0.s)
    VECTORS:  load = VECTORS, type = ro;
}

# Symbol exports for runtime
SYMBOLS {
    # Stack pointer init value (top of low RAM)
    __STACK_START__: type = export, value = $1FFF;
}
